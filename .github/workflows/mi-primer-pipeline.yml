# Nombre del pipeline que veremos en la pesta침a "Actions" de GitHub
name: Pipeline de Despliegue del Sitio Web

# 1. EL DISPARADOR (TRIGGER)
# 쮺u치ndo se va a ejecutar este pipeline?
# En este caso, cada vez que hagamos un 'push' a la rama 'main'
on:
  push:
    branches: [ main ]

# 2. LOS TRABAJOS (JOBS)
# Un pipeline se compone de uno o m치s trabajos que pueden correr en paralelo o secuencia.
jobs:
  # Definimos nuestro primer trabajo, lo llamamos "construir-y-probar"
  construir-y-probar:
    # 쮼n qu칠 tipo de m치quina virtual queremos que se ejecute? Usaremos la m치s reciente de Ubuntu.
    runs-on: ubuntu-latest

    # 3. LOS PASOS (STEPS)
    # Estos son los comandos que se ejecutar치n en secuencia dentro del trabajo.
    steps:
      # Paso 1: Clonar nuestro repositorio
      # Este 'action' pre-hecho por GitHub descarga nuestro c칩digo en la m치quina virtual.
      - name: Clonar el repositorio
        uses: actions/checkout@v3

      # Paso 2: Simular la "Construcci칩n" (Build)
      # En un proyecto real aqu칤 compilar칤amos el c칩digo. Para nuestra web, solo listaremos los archivos para verificar que todo est치 ah칤.
      - name: Listar archivos para verificar la construcci칩n
        run: ls -la

      # Paso 3: Ejecutar una "Prueba" (Test) Autom치tica
      # Verificamos que nuestro HTML tenga un t칤tulo. Si el comando 'grep' no encuentra la palabra, fallar치, y el pipeline se detendr치.
      # 춰Esto evita que c칩digo roto llegue a los usuarios!
      - name: Verificar que el index.html tiene un t칤tulo
        run: grep -q "<title>" index.html

  # Definimos un segundo trabajo para el despliegue
  desplegar:
    # Este trabajo depende del anterior. Solo se ejecutar치 si "construir-y-probar" fue exitoso.
    needs: construir-y-probar

    runs-on: ubuntu-latest
    steps:
      - name: Simular el Despliegue
        run: echo "游 Desplegando el sitio web... 춰Listo! El sitio est치 en producci칩n."
